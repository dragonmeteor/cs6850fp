import json
import sys
from sets import Set
from StringIO import StringIO

if len(sys.argv) < 2:
	print "Usage: python classify_item.py <input-file> <output-file>"

json_data=open(sys.argv[1])
data = json.load(json_data)
json_data.close()

model_tag_set = Set([
	u"mmdモデル配布あり",	
	u"mmdデータ配布あり",	
	u"mmdマシン配布あり",	
	u"mmdモデル配布",	
	u"ＭＭＤアクセサリ配布あり",	
	u"mmdモデル配布終了",
	u"ＭＭＤデータ配布あり",	
	u"再配布希望モデル",	
	u"モデル再配布希望",	
	u"ＭＭＤステージ配布あり",	
	u"モデル配布",	
	u"mmdマシンモデル配布あり",
	u"mmdモデル配布終了＆verアップ",	
	u"ＭＭＤマシン配布あり",	
	u"３Ｄ化データ配布",	
	u"モデル配布あり",	
	u"mmdモデル再配布あり",	
	u"mmdステージ配布有り",
	u"mmd楽器配布あり",	
	u"ステージ配布",	
	u"mmd装備配布あり",	
	u"mmdモデル配布一時停止",	
	u"mmdステージ配布終了",	"mmdスタンド配布あり",	
	u"mmdモデル配布終了?(lodaと共に消滅)",	
	u"mmdモデルデータ配布あり",	
	u"アクセサリ配布",	
	u"mmdアクセサリ配布",
	u"mmdモデル配布有り", 	
	u"mmmデータ配布あり", 	
	u"mmdテクスチャ配布あり", 	
	u"pmxファイル配布あり", 	
	u"水着テクスチャ配布終了",		
	u"mmdモデ配布あり",
	u"ステージ配布あり", 	
	u"モデル配布停止",	
	u"mmdデータ配布",	
	u"mmdアクセサリー配布あり",		
	u"データ配布",		
	u"ステージ再配布希望",	
	u"ＭＭＤモデル配布終了",
	u"mmdステージ配布",		
	u"ＭＭＤモデル配布アリ"	
	u"mmdモデル配布停止",	
	u"mmdアクセサリ配布終", 	
	u"モデル配布終",		
	u"パーツ配布",	
	u"mmdデータ配布アリ",
	u"配布モデル有り",	
	u"mmdモデル配布動画",	
	u"mmdデータ配布",	
	u"mmdアクセサリー配布あり",	
	u"mmdステージ配布",	
	u"ＭＭＤモデル配布アリ",
	u"mmdモデル配布停止",	
	u"mmdアクセサリ配布終了", 
	u"mmdモデル配布動画",	
	u"モデル配布アリ",	
	u"ver.1モデル配布終了いたしました",	
	u"mmd着ぐるみ配布あり",
	u"アクセサリ配布あり",	
	u"配布モデル",	
	u"mmdモデル配布再開",	
	u"服配布",	
	u"ＭＭＤアクセサリ配布",	
	u"ばね式mmdモデル配布再開",	
	u"mmdマシン配布終了",
	u"mmdモデル配布アリ",	
	u"配布モデルあり",	
	u"実はmmdアクセサリ配布あり",		
	u"モデル配布中",	"アクセ配布",	
	u"mqo配布",	
	u"mmdモデル配布あり（再開）",
	u"素材配布有",	
	u"mmdﾓﾃﾞﾙ配布あり",	
	u"おっさん、絶賛配布中ｗ",	
	u"dxmモデルデータ配布あり",	
	u"mmd衣装配布あり",	
	u"mmdアクセサリ（おまけ)配布あり",
	u"blenderデータ配布あり",	
	u"（限定）配布終了モデルあり",	
	u"dxmデータ配布あり",	
	u"phunデータ配布あり",
	u"大天使フェアリ試験pmx配布",	
	u"ＭＭＤモデル（？）配布あり",	
	u"pmxeアクセサリ配布あり",	
	u"カメラワーク配布",	
	u"モデル修正配布",	
	u"テクスチャ配布",	
	u"mmdアクセサリ配布アリ",
	u"mmoモデル配布あり",	
	u"こっそりmmdアクセサリ配布あり",	
	u"モデル用パッチ配布静画",	
	u"mmdアクセサリ配布動画",	
	u"mqoファイル配布あり",	
	u"mmdモデル指名配布実験中",	
	u"dxmアクセ配布あり",
	u"mmdアクセサリ配布あり",
	u"mmdステージ配布あり"
])
motion_tag_set = Set([
	u"mmdカメラ配布あり",	
	u"mmdポーズ配布あり",	
	u"mmdモーション配布あり",	
	u"ＭＭＤカメラモーション配布",	
	u"mmdカメラモーション配布あり",	
	u"ＭＭＤモーション配布あり",	
	u"mmdモーション配布終了",	
	u"ＭＭＤカメラ配布あり",	
	u"mmdＰＶキット配布あり"	
	u"モーション配布",	
	u"ポーズ配布",	
	u"リップモーション配布",	
	u"mmdカメラモーション配布",
	u"モーション差分配布",	
	u"mmdポーズ配布アリ",	
	u"カメラモーション配布",	
	u"dance×mixerデータ配布有り",
	u"mmdカメラ配布中止",	
	u"mmmモーション配布あり",	
	u"mmdモーション配布リンクあり",	
	u"モーション配布あり",	
	u"リップシンク配布",
	u"格闘モーション配布",	
	u"mmdポーズデータ配布",	
	u"mmdモーション配布終了？",	
	u"mmdモーション配布停止",
	u"モーション再配布希望",
	u"mmdモーション配布",	
	u"mmdモーション配布bowlroll移転",	
	u"mmdリップモーション配布",	
	u"モーションデータ配布",	
	u"カメラ配布",	
	u"モーション再配布してほしい",	
	u"mmdモーション配布アリ",
	u"配布モーションはタイムトラベラー（途中）",
	u"ポーズデータ配布あり",		
	u"mmdポーズデータ配布あり",	
	u"mmdポーズ配布",	
	u"表情モーション配布",
])
tool_tag_set = Set([
	u"mmdツール配布あり",	
	u"ツール配布",		
	u"mmmエフェクト配布あり",	
	u"ツール配布あり",	
	u"mmdエフェクト配布あり",	
	u"objectluminous配布あり",
	u"mmmプラグイン配布あり",	
	u"ＭＭＤポーズ配布あり",	
	u"恒例の杯直前エフェクト大量配布",
	u"aeスクリプト配布",	
	u"mmd弾幕配布あり",	
	u"mmdゲーム配布あり",
	u"mmmプラグイン配布",	
	u"pmdeプラグイン配布あり",	
	u"mmeエフェクト配布あり",	
	u"mmdagentデータ配布あり",	
	u"スフィアマップ配布",
	u"スクリプト配布あり",	
	u"mmmツール配布あり",	
	u"ＭＭＭプラグイン配布あり",
	u"mmeデータ配布あり",
	u"mmd講座",
	u"pmd講座",
	u"mme講座",
	u"mmdボーン講座",
	u"ニコニコ動画講座",
	u"pmde講座",
	u"mmd中級者講座",
	u"mmm講座",
	u"mmm機能講座",
	u"mmdカメラ講座",
	u"pmx講座",
	u"mmdモデル講座",
	u"mmdツール講座",
	u"mmdアクセサリ講座",
	u"mmd表情講座",
	u"mmdテクスチャ講座",
	u"mmdステージ講座",
	u"mmd演奏講座",
	u"utau講座",
	u"アイマス教養講座",
	u"mmd弾幕講座",
	u"mmd入門者講座",
	u"mmd機能講座",
	u"mmdトレース講座",
	u"aviutl講座",
	u"動画作成講座",
	u"aviutl導入講座",
	u"mmd３Ｄカスタム少女講座",
	u"tso2pmd講座",
	u"mmd3dカスタム少女講座",
	u"ＰＭＤ講座",
	u"mmdなんちゃってモデル改造講座",
	u"mmdミリタリー講座",
	u"aviutlスクリプト講座",
	u"mmd初心者講座",
	u"mmd振り付け講座",
	u"mmdモーション講座",
	u"ノベマス制作講座",
	u"aviutl集中講座",
	u"mmdリップシンク講座",
	u"mmdアクション講座",
	u"mmd-kinect講座",
	u"mmdスポーツ講座",
	u"ゲキド街生活講座",
	u"divaエディット講座",
	u"ニコニコ技術部養成講座",
	u"mmd初心～中級者向け講座",	
	u"pmdエロッタ講座",
	u"mmd静止画講座",
	u"芋でもわかるヘタＭＭＤ講座",
	u"mmd講座？",
	u"vocaloid講座",
	u"講座",
	u"東方ものしり講座",
	u"ＭＭＤ講座",
	u"mmd歩き講座",
	u"簡単にできる歩き講座",
	u"たこうさ教養講座番外編",	
	u"蒼いお侍さんによるお色気講座",
	u"mix講座",
	u"dtm講座",
	u"ＭＭＤツール講座",
	u"山高すぎて底辺が育たない講座",
	u"mmmカメラ講座",
	u"幸村講座",
	u"mmd☆モデルをふつくしく見せよう講座",
	u"mmd講座ぽいもの",
	u"blender講座",
	u"モデリング講座",
	u"pmdエディタ講座",	
	u"ＭＭＤ講座：効果音のお手本",
	u"mmm静止画講座",
	u"動画編集講座",
	u"うさたこ教養講座",
	u"紙芝居クリエーター講座",
	u"ＰＪに学ぶ死亡フラグ講座",
	u"クトゥルフ神話trpg入門講座",
	u"神威先生による命がけの中国語講座",
	u"うさたこ教養講座番外編",
	u"mmmボーン講座",
	u"ミクミク動作講座",
	u"講座動画",
	u"mmdエンコード講座",
	u"初心者にも分かりやすい講座",
	u"hanasu講座",
	u"初心者の初心者による初心者のための講座",
	u"【動画作成講座】動画ができるまで",
	u"mad講座",
	u"nive講座",
	u"aviutl基本講座",
	u"ゆっくり調教講座",
	u"mmd走り講座",
	u"uta講座",
	u"見てて楽しい講座",
	u"手旗講座",
	u"政宗先輩による夜遊び講座",
	u"musicmaker講座",
	u"初心者詐欺による初心者講座",
	u"mmd教養講座・中級編",
	u"f-san流mmd表情付け講座",
	u"mugenキャラ作成講座",
	u"ＵＴＡＵ講座",
	u"キメラワーク講座",
	u"utau動画講座",
	u"恋愛講座(上級者向け)",
	u"mmd運転講座",
	u"3dcg講座",
	u"3dチュートリアル",
	u"大殿の戦講座",
	u"ここまでチュートリアル",
	u"ドイツ語講座",
	u"3:15からトレース講座",
	u"ＭＭＤ教えて講座",
	u"ゆっくりmmd講座",
	u"mmd-pv講座",
	u"slhl講座",
	u"初心者でも分かるガンダム講座",
	u"悪魔博士の名古屋弁講座",
	u"彼岸花講座",
	u"女声講座",
	u"ニコニコ動画編集講座",
	u"今日からドキドキ奥州語講座",
	u"aviutlチキンレース講座",
	u"ガンプラ講座",
	u"動作作成講座",
	u"初心者講座",
	u"反面教師mix講座＾＾；",
	u"ae講座",
	u"人体講座",
	u"お絵描き講座",
	u"お絵描き講座part1リンク",
	u"美容整形講座",
	u"ニコニコ歴史講座",
	u"交通安全講座",
	u"mmd研究講座",
	u"ＭＡＤ講座",
	u"初音ミク育成講座",
	u"ウォーキング講座",
	u"ニコニコマナー講座",
	u"@講座",
	u"mmd指ポーズ講座",
	u"スペイン語講座",
	u"音ずれ講座ｗｗｗ",
	u"ニコニコフィギュアスケート講座",
	u"ニコニコ講座",
	u"月刊ニコ技講座",
	u"mmd講座ｗ",
	u"mmd講座（笑）",
	u"先生、講座になってません",
	u"3dカスタム講座",
	u"mmd救命講座",
	u"ＭＭＤ歩き方講座",
	u"歩き講座見るべし",
	u"ニコニコ仏語講座",
	u"ニコニコ物理講座",
	u"カメラモーション講座",
	u"mmd講座：課題作",
	u"mmd教養講座",
	u"しゅしゅpのmmdストリートダンス講座",
	u"mmdで関節技講座",
	u"mmdクッキング講座",
	u"まさかの教養講座",
	u"mmd解説講座",
	u"氷上の動き講座",
	u"mmd歴史講座",
	u"ddr講座",
	u"ニコニコ動画講座（予定）",
	u"ニコニコお絵かき講座",
	u"ＭＭＤ動画講座",
	u"mmmリップシンク講座",
	u"ＤＴＭ講座",
	u"作曲講座",
	u"トークロイド講座",	
	u"ＷＭＭ講座",
	u"職人によるエディット講座",	
	u"basaraloid養成講座",	
	u"pmde講座っぽい何か"	
])
editing_tag_set = Set([
	u"ランキング動画", 
	u"ランキング", 
	u"ニコニコランキング", 
	u"utauランキング", 
	u"週刊utauランキング", 
	u"vocaloidランキング", 	
	u"巡音新曲ランキング", 
	u"vocaloidオリ曲ランキング外伝", 
	u"ニコニコランキングsp", 
	u"週刊東方ランキングの人ホイホイ",
	u"mikumikudanceランキング", 
	u"週刊ＵＴＡＵランキング", 
	u"海外組vocaloidランキング", 
	u"週刊ニコニコ歌ってみたランキング", 
	u"週刊ニコニコランキング"
	u"ガチムチパンツランキング", 
	u"ブロリーランキング", 
	u"ahs新曲ランキング", 
	u"週刊ランキングの人ホイホイ", 
	u"鏡音ランキング",
	u"インタネ新曲ランキング", 
	u"踊ってみたランキング", 
	u"俺ランキングシリーズ", 
	u"人類には早すぎるランキング", 
	u"週刊東方ランキング",
	u"週刊utauオリジナル曲ランキング", 
	u"週刊vocaloidとutauランキング", 
	u"週刊vocaloidランキング", 
	u"シュッとしたランキング", 
	u"週刊東方mmdランキング",
	u"東方ランキング", 
	u"日刊vocaloidランキング", 
	u"月刊utauランキング", 
	u"たこルカランキング",
	u"kaitoランキング", 
	u"kaito新曲ランキング",
	u"東方mmdランキング", 
	u"週刊アイドルマスターランキング", 
	u"月刊minecraftランキング", 
	u"鏡音新曲ランキング", 
	u"月間acmmdランキング",
	u"月刊結月ゆかりランキング", 
	u"週刊音madランキング", 
	u"mmdランキング", 
	u"ランキング外の第三勢力", 
	u"進撃のランキング", 
	u"自作ダンスモーションランキング",
	u"bsr48中間ランキング", 
	u"vocaloidランキングsp", 
	u"肌色気味のランキング",
	u"月刊東方ランキング", 
	u"むせるランキング", 
	u"乗降者数ランキングシリーズ",
	u"mmdの将来が不安になるランキング", 
	u"mmdの将来に希望が持てるランキング", 
	u"けいおん！ランキング", 
	u"mmdの将来に希望と不安が渦巻くランキング",
	u"love&joyランキング", 
	u"mmd腹筋崩壊ランキング", 
	u"im@s架空戦記ランキング", 
	u"繋ぎに定評があるランキング", 
	u"カオスの多いランキング", 
	u"歪みねぇランキング",
	u"草ランキング", 
	u"えろ豆先生ランキング", 
	u"杯動画ランキング", 
	u"vocaloid新曲ランキングsp", 
	u"2008上半期ランキング", 
	u"カオスランキング", 
	u"日刊vocaloidランキング増刊号",
	u"日刊vocaloid週間ランキング", 
	u"ＶＯＣＡＬＯＩＤランキング", 
	u"ボカマスランキング", 
	u"love＆joyランキング", 
	u"実はmmdランキング", 
	u"mac音ナナランキング", 
	u"月刊mac音ナナランキング", 
	u"月刊utauオリジナル曲ランキング", 
	u"突発ランキング", 
	u"ラマーズpランキング", 
	u"恋愛サーキュレーションランキング", 
	u"ランキング動画第1回", 
	u"ニコニコタグ別ランキング",
	u"テトオリジナル曲ランキング",
	u"ニコゲーランキング",
	u"魂実装済ランキング",
	u"月刊ニコニコランキング",
	u"第6回mmd杯たこルカランキング",
	u"ラマーズＰランキング",
	u"東方mmdランキング増刊号",
	u"オレ的タグ検索動画ランキング",	
	u"meikoランキング",
	u"無修正ランキング",
	u"タグランキング",	
	u"カオスなランキング",
	u"なんというpvランキング",
	u"よくもこんなキチガイランキングを!",
	u"健康的なランキング",
	u"月刊ぽっぴぽーランキング",	
	u"重度感染者ランキング",	
	u"初音新曲ランキング",
	u"2009上半期ランキング",
	u"がくっぽいどランキング",
	u"名曲おさらいランキング",
	u"vocaloid-pvランキング",
	u"月刊mac音ナナランキング最終回",		
	u"ボカロランキング2009年12月リンク",
	u"vocaloid初動30日ランキング",
	u"月刊voc@loidランキング",
	u"ボカロランキング2009年11月リンク",
	u"ボカロランキング2010年1月リンク",
	u"ランキング除外のランキング",
	u"ニコニコメドレーランキング",			
	u"月刊東方自作アレンジランキング",
	u"週刊エルシャダイランキング",	
	u"アイマス嘘ランキング",	
	u"gumi新曲ランキング",	
	u"utau新曲ランキングsp",
	u"vocaloidランキング海外組",		
	u"がくぽ新曲ランキング",
	u"meiko新曲ランキング",
	u"マイリス度ランキング",
	u"月刊新作東方手書きランキング",	
	u"東方ランキングsp2011",
	u"東方ランキングsp2012",
	u"年間ランキング",
	u"東方ランキングsp",
	u"東方ランキングsp2009",
	u"東方ランキングsp2010"	
	u"比較動画",
	u"第7回mmd杯本選作品比較動画",
	u"比較：再現mad",
	u"第9回mmd杯本選作品比較動画",
	u"比較:mikumikudance",
	u"比較画像",
	u"比較",
	u"第10回mmd杯本選作品比較動画",
	u"第10回mmd杯本選作品比較動画比較動画",
	u"第11回mmd杯本選作品比較動画",
	u"第8回mmd杯本選作品比較動画",
	u"自作比較動画",
	u"比較版",
	u"ダンス×モーショントレース比較",
	u"セルフ比較",
	u"比較：再現ＭＡＤ",
	u"比較用",
	u"比較対象がおかしい",
	u"第８回mmd杯本選作品比較動画",
	u"モーション比較",
	u"第4回mmd杯本選作品比較動画",
	u"第6回mmd杯本選作品比較動画",
	u"進撃の比較",
	u"比較してみた",
	u"比較を作るのがちょいと早すぎたかい？",
	u"俺は比較版を2時間フラットで作れるんだ",
	u"第5回mmd杯本選作品比較動画",
	u"比較してわかる凄さ",
	u"アイドルマスター比較動画",
	u"スタイリッシュ比較動画",
	u"マイケルの凄さも分かる比較",
	u"比較で分かる再現率の高さ",
	u"比較してよりわかる再現度の高さ",
	u"透過比較",
	u"オチまで余す所なく完全に比較",
	u"人類は比較しました",
	u"比較サイド",
	u"エフェクト比較",
	u"第10回mmd杯比較動画",
	u"第9回mmd本選作品比較動画",
	u"比較放棄",
	u"apヘタリア比較動画",
	u"売上比較※自重",
	u"なぜ比較した",
	u"比較:再現mad",
	u"第１０回mmd杯本選作品比較動画",
	u"比較版ジェバンニ",
	u"vocaloid元ネタ比較リンク",
	u"第９回mmd杯本選作品比較動画",
	u"比較してもうるさい",
	u"第4回東方ニコ童祭支援比較",
	u"比較用動画",
	u"第９回mmd杯本選動画比較作品",
	u"まどか☆マギカ比較リンク",
	u"第5回mmd杯本選比較動画",
	u"なぜ比較したし",
	u"イース音楽比較",
	u"比較は0:55から",
	u"とどまることを知らない比較対象数",
	u"ニュースケファン待望の比較動画",
	u"75分後の比較",
	u"比較対照の見えない比較版",
	u"比較がどうでもいい動画",
	u"比較:踊ってみた",
	u"mmd比較動画",
	u"この比較、イエスだね！",
	u"比較×比較動画",
	u"自己比較",
	u"しかし、すでにセルフ比較をしていた",
	u"比較動画ｗ",
	u"mmd比較",
	u"比較しづらい比較動画",
	u"最初から比較動画付き↘",
	u"比較静画",
	u"ガンダムseed比較動画",
	u"人力比較動画",
	u"日常op2パロ比較リンク",
	u"何故比較した",
	u"胸囲の比較動画",
	u"第10回mmd杯本選比較動画",
	u"比較動画はよ",
	u"比較するでない",
	u"第４回mmd杯本選作品比較動画",	
	u"動画紹介動画",
	u"モデル紹介",
	u"mmd機能紹介",
	u"utau音源紹介動画",
	u"一般人にもお勧めシリーズ",
	u"mmdモデル紹介",
	u"紹介動画",
	u"邪神紹介動画",
	u"utauお勧めカバー曲",
	u"フリーゲーム紹介リンク",
	u"ユーザーモデル紹介",
	u"ヒデローお勧め",
	u"歌らん紹介動画",
	u"スタイリッシュmod紹介",
	u"ヒーロー紹介動画",
	u"素材紹介",
	u"未配布衣装紹介",
	u"デッキ紹介",
	u"参加者紹介",
	u"アイドル紹介シリーズ",
	u"東方キャラ紹介",
	u"mmd車両モデル紹介",
	u"歌い手紹介動画リンク",
	u"歌い手を１０００人紹介してみた！",
	u"【世界の新着動画】エンタメ・音楽紹介動画",
	u"紹介がおまけ",
	u"紹介映像",
	u"廃墟ステージ紹介",
	u"perfumeお勧め動画",
	u"mmd新着モデル紹介動画",
	u"パンツ紹介動画",
	u"ラジＰ生放送紹介作品",
	u"ロゴ紹介",
	u"ルート紹介",
	u"配布終了衣装紹介",
	u"性格の出るモデル紹介",
	u"未配布オプション紹介",
	u"団（クラブ）紹介",
	u"東方紹介",
	u"自己紹介",
	u"キャラ紹介",
	u"mmm機能紹介",
	u"第10回mmd杯予選はラストで紹介",	
	u"モデルを見せる気のないモデル紹介動画",
	u"minecraftスキン紹介動画",
	u"動画紹介",
	u"キャラ紹介は18：24～"	
])


nodes = data["nodes"]
for node_name in nodes:
	node = nodes[node_name]
	node["categories"] = []	
	tags = node["tags"]

	# Classify model.
	is_model = False
	for tag in tags:
		tag = tag.lower()
		if tag in model_tag_set:
			is_model = True
	if is_model:
		node["categories"].append("model")

	is_motion = False
	for tag in tags:
		tag = tag.lower()
		if tag in motion_tag_set:
			is_motion = True
	if is_motion:
		node["categories"].append("motion")

	is_tool = False
	for tag in tags:
		tag = tag.lower()
		if tag in tool_tag_set:
			is_tool = True
	if is_tool:
		node["categories"].append("tool")

	is_editing = False
	for tag in tags:
		tag = tag.lower()
		if tag in editing_tag_set:
			is_editing = True
	if is_editing:
		node["categories"].append("editing")

	if len(node["categories"]) == 0:
		node["categories"].append("cg")

	#print

import codecs
fout = codecs.open(sys.argv[2], "w", "utf-8")
json.dump(data, fout, ensure_ascii=False, encoding="utf-8", indent=1)
fout.close()
